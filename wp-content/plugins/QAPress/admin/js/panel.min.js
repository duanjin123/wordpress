!function(e){function n(n){for(var a in n){for(var t=e('[data-name="'+a+'"]'),i="",l=0;l<n[a].y.length;l++)n[a].y[l]&&n[a].y[l].name&&(i+='<label class="checkbox-inline"><input name="'+a+'[]" checked type="checkbox" value="'+n[a].y[l].id+'"> '+n[a].y[l].name+"</label>");for(var c=0;c<n[a].n.length;c++)n[a].n[c]&&n[a].n[c].name&&(i+='<label class="checkbox-inline"><input name="'+a+'[]" type="checkbox" value="'+n[a].n[c].id+'"> '+n[a].n[c].name+"</label>");t.html(i)}}e("#wpcom-panel-form").on("click",".upload-btn",function(n){n.preventDefault();var a,t=e(this).attr("id");a?a.open():((a=wp.media.frames.file_frame=wp.media({title:"选择文件",button:{text:"选择文件"},multiple:!1})).on("select",function(){var n=a.state().get("selection").first().toJSON(),i=t.replace(/_upload/i,"");e("#"+i).val(n.url)}),a.open())}).on("click",".toggle",function(){var n=e(this);n.hasClass("active")?(n.removeClass("active"),n.next().val(0)):(n.addClass("active"),n.next().val(1))}).on("change",".toggle-wrap input",function(){var n=e(this);1==n.val()?n.parent().find(".toggle").addClass("active"):n.parent().find(".toggle").removeClass("active")}).find(".color-picker").wpColorPicker();var a=e(".j-cat-sort"),t={};if(a.length)for(var i=0;i<a.length;i++){var l=e(a[i]).data("name");t[l]={},t[l].y=[],t[l].n=[],e(a[i]).find("label").each(function(n,a){e(a).find("input").is(":checked")?t[l].y.push({id:e(a).find("input").val(),name:e.trim(e(a).text())}):t[l].n.push({id:e(a).find("input").val(),name:e.trim(e(a).text())})})}n(t),a.on("change","input",function(){for(var a=e(this),i=a.closest(".j-cat-sort").data("name"),l=a.is(":checked"),c=0;c<t[i][l?"n":"y"].length;c++)t[i][l?"n":"y"][c]&&t[i][l?"n":"y"][c].id==a.val()&&delete t[i][l?"n":"y"][c];t[i][l?"y":"n"].push({id:a.val(),name:e.trim(a.parent().text())}),n(t)})}(jQuery);